#wrapper

	= render :partial => 'layouts/shared/header'

	#content.row{ 'ng-controller' => 'InstantIngredientSearchForNewRecipeController', 'ng-init' => "editInit()" }
		#anhadirIng.large-4.columns
			#new_link
				= text_field :link, :number, 'ng-model' => 'numberOfIng', placeholder: 'Nº'
				%select{:id => 'link_unit', "ng-model" => "selected_unit", "ng-options" => "u.unit for u in units"}
				= text_field :link, :ingredient, 'ng-model' => 'searchString', placeholder: 'Nombre'
				%select{:id => 'link_importance', "ng-model" => "importanceOfIng", "ng-options" => "i.description for i in importances"}
				%span.btn_addIng.ion-ios7-plus-outline{'ng-click' => 'addLink()'}

			%table{ 'ng-show' => 'searchString.length >= 2', :class => 'resultIngForRecipeTable' }
				%tr{ 'ng-repeat' => 'i in ingredients | searchFor:searchString', 'ng-click' => 'setValue(i)', :class => 'resultIng' }
					%td.resultIng{'ng-bind' => 'i.name'}

			#listaIng
				%ul
					%li{ 'ng-repeat' => 'link in links', 'ng-hide' => 'link.destroy' }
						%span.remove.ion-ios7-close-empty{ 'ng-click' => 'removeSavedLink($index)' }
						%span{'ng-bind' => 'link.number'}
						%span{'ng-bind' => 'link.unit.description'}
						%span{'ng-bind' => 'link.ing.name'}
						(
						%span{'ng-bind' => 'link.importance.description'}
						)

		#mainNuevaReceta.large-8.columns
			#nuevaReceta
				#titulo
					= text_field :recipe, :title, placeholder: 'Título', 'ng-model' => 'recipeTitle'

				#descripcion
					= text_field :recipe, :description, placeholder: 'Descripción', 'ng-model' => 'recipeDescription'

				%input#photoUpload{ :type => 'file', :onchange => 'angular.element(this).scope().readFile()' }

				#detalles.row
					#tiempo.large-4.columns
						= text_field :recipe, :time, placeholder: 'Tiempo', 'ng-model' => 'recipeTime'
					#comensales.large-4.columns
						= text_field :recipe, :servings, placeholder: 'Comensales', 'ng-model' => 'recipeServings'
					#dificultad.large-4.columns
						%select.selector_dif{ placeholder: 'Dificultad', "ng-model" => "recipeDifficulty", "ng-options" => "d.description for d in difficulties"}

				#pasos
					#newStep
						= hidden_field :step, :id, 'ng-model' => 'idStep'
						%textarea.newStep_description{ placeholder: 'Añada los pasos de la receta aquí', 'ng-model' => 'textStepRec', 'ng-keyup' => 'enterKeyStep($event)'}
						%span.btn_removeStep.ion-ios7-close-outline{'ng-click' => 'removeStep($index)', 'ng-show' => 'editIndex >= 0'}
						%span.btn_addStep.ion-ios7-plus-outline{'ng-click' => 'addStep()'}

					%ul.stepList
						%li{ 'ng-repeat' => 'step in steps' }
							%span.step_description{'ng-bind' => 'step.description', 'ng-class' => "{ 'step_edit': $index == editIndex }", 'ng-click' => 'editStep($index)'}


				#crearReceta
					= button_tag 'Modificar receta', class: 'btn_crearReceta', type: :submit, 'ng-click' => 'updateRecipe()'

				= hidden_field_tag 'idRecipeHidden', @recipe.id, id: 'idRecipeHidden'
				= hidden_field_tag 'linksHidden', @recipe.links.to_json, id: 'linksHidden'
				= hidden_field_tag 'stepsHidden', @recipe.steps.to_json, id: 'stepsHidden'
				= hidden_field_tag 'difficultyHidden', @recipe.difficulty.to_json, id: 'difficultyHidden'
				= hidden_field :recipe, :photo


	= render :partial => 'layouts/shared/footer'
