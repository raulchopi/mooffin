%html
%body{ 'ng-app' => 'instantIngredientsSearch' }

= render :partial => 'layouts/shared/header'

#content{ 'ng-controller' => 'InstantIngredientSearchForNewRecipeController' }
	#anhadirIng
		#new_link
			= text_field :link, :number, 'ng-model' => 'numberOfIng'
			= collection_select :link, :unit, Unit.all, :id, :description, :id => 'link_unit', 'ng-model' => 'unitOfIng', 'ng-change' => 'prueba()'
			= text_field :link, :ingredient, 'ng-model' => 'searchString' 			
			= collection_select :link, :importance, Importance.all, :id, :description, 'ng-model' => 'importanceOfIng'
			= button_tag '+', class: 'btn_addIng', type: :submit, 'ng-click' => 'addLink()'

		%table{ 'ng-show' => 'searchString.length >= 2', :class => 'resultIngForRecipeTable' }
			%tr{ 'ng-repeat' => 'i in ingredients | searchFor:searchString', 'ng-click' => 'setValue(i)', :class => 'resultIng' }
				%td.resultIng{'ng-bind' => 'i.name'}

		#listaIng
			%ul
				%li{ 'ng-repeat' => 'link in links' }
					%span{ 'ng-click' => 'removeLink($index)' } x
					%span{'ng-bind' => 'link.number'}
					%span{'ng-bind' => 'link.unit.description'}
					%span{'ng-bind' => 'link.ing.name'}
					%span{'ng-bind' => 'link.importance'}
		
	#mainNuevaReceta
		#nuevaReceta
			#titulo			
				= label :title, "Título"
				= text_field :recipe, :title, 'ng-model' => 'recipeTitle'
			= file_field :recipe, :photo, 'onchange' => 'angular.element(this).scope().setFile(this)'
			#detalles
				#tiempo
					= label :time, "Tiempo"
					= text_field :recipe, :time, 'ng-model' => 'recipeTime'
				#comensales
					= label :servings, "Comensales"
					= text_field :recipe, :servings, 'ng-model' => 'recipeServings'
				#dificultad
					= label :difficulty_id, "Dificultad"
					= collection_select :recipe, :difficulty_id, Difficulty.all, :id, :description, 'ng-model' => 'recipeDifficulty'

			#pasos
				Añada los pasos de la receta:
				%ul.stepList
					%li{ 'ng-repeat' => 'step in steps' }
						%span.step_description{'ng-bind' => 'step.description'}					
						%span.remove_step{'ng-click' => 'editStep($index)'}
							= image_tag('edit.png', :border => 0, size: '15')
						%span.remove_step{'ng-click' => 'removeStep($index)'}
							= image_tag('delete.png', :border => 0, size: '15')
				#newStep
					%textarea.newStep_description{'ng-model' => 'textStepRec', 'ng-keyup' => 'enterKeyStep($event)'}
					%span.addStep{'ng-click' => 'addStep()'} +

			#crearReceta
				= button_tag 'Crear', class: 'signup_btn', type: :submit, 'ng-click' => 'createRecipe()'			


		
= render :partial => 'layouts/shared/footer'