# -*- encoding : utf-8 -*-
class AddLowerUnaccentFunctionToDb < ActiveRecord::Migration
  def self.up
    execute "CREATE OR REPLACE FUNCTION lower_unaccent(character varying)
      RETURNS text
      AS $$
      SELECT lower(translate($1
           , '¹²³áàâãäåāăąÀÁÂÃÄÅĀĂĄÆćčç©ĆČÇĐÐèéêёëēĕėęěÈÊËЁĒĔĖĘĚ€ğĞıìíîïìĩīĭÌÍÎÏЇÌĨĪĬłŁńňñŃŇÑòóôõöōŏőøÒÓÔÕÖŌŎŐØŒř®ŘšşșßŠŞȘùúûüũūŭůÙÚÛÜŨŪŬŮýÿÝŸžżźŽŻŹ'
           , '123aaaaaaaaaaaaaaaaaaacccccccddeeeeeeeeeeeeeeeeeeeeggiiiiiiiiiiiiiiiiiillnnnnnnooooooooooooooooooorrrsssssssuuuuuuuuuuuuuuuuyyyyzzzzzz'
           ));
      $$ IMMUTABLE STRICT LANGUAGE SQL;"
  end
  def self.down
    execute "drop function lower_unaccent(text) cascade"
  end
end
